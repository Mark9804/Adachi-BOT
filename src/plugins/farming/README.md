# 锄地组队功能草案

## 发起锄地

### 1. 发起方发送消息

发起方：`@机器人 锄地 <房主@指定的某一名群友作为房主> [时间]`

\*如不指定房主则默认房主为发起方

e.g. `@阿晴 锄地 房主@123456789 19:00`

\*考虑兼容不同时间格式，例：`9点/9时（24小时制）`；`早上9点/早上9时`；`21点/21：00（默认24小时制？）`

\*\*也有可能太懒了于是直接从用户层面解决问题

### 2. 机器人反馈

写入数据库

反馈：`[CQ:at,qq=${userID1}]发起{时间}的锄地组队，房主为[CQ:at,qq=${userID1}]\n直接回复“锄地报名”上车`

### 3. 用户报名

报名：`锄地报名`

### 4. 机器人反馈

检查数据库内是否存在四个以上的键值对（第一个月暂时不启用锁定机制）

反馈：`([CQ:at,qq=${userID}]锄地报名成功。人数n/4 | 报名人数已满，第一个月试运行会继续添加到锄地名单中，从第二个月开始就不能报名了捏)\n我会在${time-5min}提醒你。耽误的时间太多，事情可就做不完了。`

### 5. （不知道能不能实现）到点（-5 分钟前）发送消息

发送：`预约的锄地时间快要到了，在[CQ:at,qq=${房主QQ}]家集合吧。\n[CQ:at,qq=${userID1}][CQ:at,qq=${userID2}][CQ:at,qq=${userID3}]`

# 数据库结构

lowdb 本质上是 json 文件。

需要记录的信息为：

- 锄地时间（timestamp）
- 房主的 QQ
- 参与者的 QQ

例：

```json
{
    "1632839977": [
        "host": "123456789",
        "participants": ["111111111", "222222222", "333333333", "444444444" ]
    ]
}
```
